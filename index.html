<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MEGA Chat – Connect Freely</title>

  <!-- Firebase (ES modules) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    // ---------- your Firebase config (from your message) ----------
    const firebaseConfig = {
      apiKey: "AIzaSyD8-JOU1GSyVrjPf43UBBakwOgmaDLjCxA",
      authDomain: "mega-910bd.firebaseapp.com",
      projectId: "mega-910bd",
      storageBucket: "mega-910bd.firebasestorage.app",
      messagingSenderId: "1077865554196",
      appId: "1:1077865554196:web:235e3c9bf3f1f57953e201"
    };
    // ----------------------------------------------------------------

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Expose a function to the page to save a report
    window.sendReportToFirestore = async (reportData) => {
      try {
        await addDoc(collection(db, "reports"), {
          ...reportData,
          createdAt: serverTimestamp()
        });
        return { ok: true };
      } catch (err) {
        console.error("Firestore addDoc error:", err);
        return { ok: false, error: err };
      }
    };
  </script>

  <style>
    :root{
      --accent: #25D366;
      --accent-dark: #1DA851;
      --bg: #f4f6f8;
      --card: #ffffff;
      --muted: #666;
      --max-width: 980px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:var(--bg);
      color:#111;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.6;
    }

    header{
      background:linear-gradient(90deg,var(--accent),#2bd07a);
      color:white;
      padding:18px 16px;
      text-align:left;
      display:flex;
      align-items:center;
      gap:12px;
      box-shadow:0 3px 10px rgba(0,0,0,0.08);
      position:sticky;
      top:0;
      z-index:50;
    }
    header .brand {
      font-weight:700;
      font-size:1.2rem;
      letter-spacing:0.4px;
    }
    header .subtitle {
      margin-left:auto;
      font-size:0.9rem;
      opacity:0.95;
      padding-right:12px;
    }

    main{
      max-width:var(--max-width);
      margin:32px auto;
      background:var(--card);
      border-radius:14px;
      padding:32px;
      box-shadow:0 8px 30px rgba(12,18,24,0.06);
    }

    h1{ margin:0 0 12px 0; color: #0b3a2b }
    h2{ color:var(--accent); margin-top:26px; }

    .video-wrap{
      width:100%;
      max-width:820px;
      margin:18px auto;
      border-radius:12px;
      overflow:hidden;
      box-shadow:0 8px 30px rgba(2,10,5,0.06);
    }
    iframe{
      width:100%;
      height:450px;
      border:0;
      display:block;
    }

    /* The very long message area */
    .long-text{
      font-size:1.02rem;
      color:#1d1d1d;
      white-space:pre-wrap;
      margin-top:8px;
    }
    .support-inline{
      color:var(--accent);
      font-weight:700;
      cursor:pointer;
      text-decoration:underline;
    }

    /* Corner floating buttons */
    .corner-buttons{
      position:fixed;
      right:18px;
      bottom:18px;
      display:flex;
      flex-direction:column;
      gap:10px;
      z-index:999;
    }
    .corner-buttons button,
    .corner-buttons a{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      background:var(--accent);
      color:white;
      padding:12px 16px;
      border-radius:999px;
      border:none;
      font-weight:600;
      box-shadow:0 8px 20px rgba(0,0,0,0.12);
      cursor:pointer;
      text-decoration:none;
      min-width:64px;
      transition:transform .12s ease, background .12s ease;
    }
    .corner-buttons button:hover,
    .corner-buttons a:hover{ transform:translateY(-3px); background:var(--accent-dark); }

    footer{
      max-width:var(--max-width);
      margin:28px auto 56px;
      text-align:center;
      color:var(--muted);
      font-size:0.95rem;
    }

    /* Modal styles (report + support) */
    .modal-backdrop{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.48);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:1000;
      padding:20px;
    }
    .modal{
      width:100%;
      max-width:520px;
      background:white;
      border-radius:12px;
      padding:20px;
      box-shadow:0 18px 50px rgba(0,0,0,0.2);
    }
    .modal h3{ margin:0 0 10px 0; }
    .field{ margin:10px 0; }
    input[type="text"], input[type="email"], textarea{
      width:100%;
      padding:10px 12px;
      border-radius:8px;
      border:1px solid #dbe3df;
      font-size:1rem;
      resize:vertical;
    }
    .row{ display:flex; gap:10px; }
    .btn{
      background:var(--accent);
      color:white;
      border:none;
      padding:10px 14px;
      border-radius:8px;
      cursor:pointer;
      font-weight:700;
    }
    .btn.secondary{ background:#f1f1f1; color:#333; box-shadow:none; }
    .note{ font-size:0.9rem; color:#666; margin-top:8px; }

    @media (max-width:760px){
      iframe{ height:260px; }
      main{ margin:18px 12px; padding:20px; }
      .corner-buttons{ right:12px; bottom:12px; }
    }
  </style>
</head>
<body>

  <header id="top">
    <div class="brand">MEGA Chat</div>
    <div class="subtitle">Private • Real-time • Peer-to-peer</div>
  </header>

  <main>
    <h1>Welcome to MEGA — Connect Freely</h1>

    <div class="long-text" id="longText">
      <!-- LONG MESSAGE: generated below by JS to avoid huge HTML payload -->
    </div>

    <h2>App Preview</h2>
<div class="video-wrap">
  <!-- Replace VIDEO_ID with your YouTube video ID -->
  <iframe 
    width="560" 
    height="315" 
    src="https://www.youtube.com/embed/-8bx-a5TlYk?si=F-q2an-_TTL7qMan" 
    title="MEGA Chat Demo" 
    frameborder="0" 
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
    allowfullscreen>
  </iframe>
</div>

    <p class="note">If you need help, tap the <span style="font-weight:700;color:var(--accent)">Support</span> link inside the message above — it will open a quick support box.</p>
  </main>
<!-- ========== SITE LINKS + INTERNAL PAGES (paste this where you want it) ========== -->
<section id="siteLinksContainer" aria-label="Useful links and pages" style="margin:28px 0;">
  <h3 style="margin-bottom:12px;">Explore</h3>

  <div id="linksGrid" class="links-grid" role="navigation" aria-label="Site navigation">
    <!-- Buttons - data-page must match pages keys -->
    <button data-page="download" class="link-item">Download</button>
    <button data-page="whatsapp-logo" class="link-item">WhatsApp Main Logo</button>
    <button data-page="about" class="link-item">About us</button>
    <button data-page="careers" class="link-item">Careers</button>
    <button data-page="brand-center" class="link-item">Brand Center</button>
    <button data-page="privacy" class="link-item">Privacy</button>

    <button data-page="use-whatsapp" class="link-item">Use WhatsApp</button>
    <button data-page="android" class="link-item">Android</button>
    <button data-page="iphone" class="link-item">iPhone</button>
    <button data-page="desktop" class="link-item">Mac/PC</button>
    <button data-page="web" class="link-item">WhatsApp Web</button>

    <button data-page="contact" class="link-item">Contact Us</button>
    <button data-page="help" class="link-item">Help Center</button>
    <button data-page="apps" class="link-item">Apps</button>
    <button data-page="security-advisories" class="link-item">Security Advisories</button>
    <button data-page="features" class="link-item">Features</button>

    <button data-page="blog" class="link-item">Blog</button>
    <button data-page="security" class="link-item">Security</button>
    <button data-page="for-business" class="link-item">For Business</button>
    <button data-page="who-we-are" class="link-item">Who we are</button>
  </div>
</section>

<!-- Page viewer (hidden by default) -->
<main id="pageView" class="page-view" aria-hidden="true" style="display:none;">
  <div class="page-inner">
    <header class="page-header">
      <button id="pageBack" class="btn-back" aria-label="Back">← Back</button>
      <h1 id="pageTitle">Title</h1>
    </header>

    <article id="pageContent" class="page-content" tabindex="0">
      <!-- populated by JS -->
    </article>

    <footer class="page-footer">
      <div class="feedback">
        <div class="question">Was this helpful?</div>
        <div class="answers">
          <button id="fbYes" class="fb-btn">Yes</button>
          <button id="fbNo" class="fb-btn">No</button>
        </div>
      </div>
    </footer>
  </div>
</main>

<!-- Report modal (hidden) -->
<div id="reportModal" class="report-modal" style="display:none;" role="dialog" aria-modal="true" aria-labelledby="reportTitle">
  <div class="report-box">
    <h3 id="reportTitle">Tell us what went wrong</h3>
    <textarea id="reportText" placeholder="Write your message..." rows="6"></textarea>
    <div class="report-actions">
      <button id="sendReport" class="primary">Send</button>
      <button id="cancelReport">Cancel</button>
    </div>
  </div>
</div>

<!-- Minimal styles -->
<style>
.links-grid { display:grid; gap:10px; grid-template-columns: repeat(auto-fit, minmax(160px,1fr)); margin-bottom:18px; }
.link-item { background:#fff; border:1px solid #e6e6e6; padding:10px 12px; text-align:left; font-size:14px; border-radius:8px; cursor:pointer; transition:transform .08s, box-shadow .12s; box-shadow:0 1px 2px rgba(0,0,0,.03); }
.link-item:hover{ transform:translateY(-3px); box-shadow:0 6px 18px rgba(0,0,0,.06); }
.page-view { position:fixed; inset:0; background:rgba(0,0,0,0.45); display:flex; align-items:flex-start; justify-content:center; padding:40px 12px; z-index:1200; }
.page-inner { width:100%; max-width:900px; background:var(--card-bg,#fff); border-radius:10px; box-shadow:0 30px 80px rgba(0,0,0,0.35); overflow:auto; max-height:90vh; }
.page-header { display:flex; align-items:center; gap:12px; padding:18px; border-bottom:1px solid #eee; }
.btn-back { background:none; border:none; font-size:16px; cursor:pointer; padding:8px; }
.page-content { padding:18px; line-height:1.55; color:var(--text-color,#222); }
.page-footer { padding:14px 18px; border-top:1px solid #eee; display:flex; justify-content:flex-end; align-items:center; gap:12px; }
.feedback .question { font-weight:600; margin-right:12px; }
.fb-btn { padding:8px 12px; border-radius:8px; border:1px solid #ddd; background:#fff; cursor:pointer; }
.fb-btn:hover { background:#f6f6f6; }
.report-modal { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.5); z-index:1400; }
.report-box { width:100%; max-width:620px; background:#fff; padding:18px; border-radius:10px; box-shadow:0 18px 60px rgba(0,0,0,0.3); }
.report-box textarea { width:100%; padding:10px; border-radius:8px; border:1px solid #ddd; resize:vertical; }
.report-actions { margin-top:10px; display:flex; gap:8px; justify-content:flex-end; }
.primary { background:#007bff; color:#fff; border:none; padding:8px 12px; border-radius:8px; cursor:pointer; }
.primary:hover { background:#0066d9; }
</style>

<!-- Script: internal pages + feedback/report handling -->
<script>
(function(){
  // Define per-page long text. Edit these strings to your real content.
  const pages = {
    "download": {
      title: "Download",
      content: `
        <h2>Download</h2>
        <p>Get MEGA on all major platforms. Our apps are optimized for speed, reliability, and privacy. Download links, installation steps, and system requirements are provided below. Please read each platform's specific guidance for permissions and battery optimization to ensure the app runs smoothly.</p>
        <p><strong>Windows & Mac:</strong> Use the desktop app for file management and larger uploads. Install from the official site and follow the installer prompts.</p>
        <p><strong>Mobile:</strong> Android and iPhone installers are signed and available from official stores. If you side-load or install an APK, check signatures carefully.</p>`
    },
    "whatsapp-logo": {
      title: "WhatsApp Main Logo",
      content: `
        <h2>WhatsApp Main Logo</h2>
        <p>This page contains official brand resources, logo assets and usage guidelines. When using the WhatsApp (or MEGA) logo in your materials, follow the brand rules: keep clear space, don't alter the mark, and use approved colors. Download high-resolution PNG/SVG assets from the Brand Center link.</p>`
    },
    "about": {
      title: "About us",
      content: `
        <h2>About us</h2>
        <p>MEGA is built to provide secure, lightweight messaging for everyone. We believe in privacy by design: messages are encrypted, minimal data is stored, and you control your communication. Our team is distributed globally, working on performance, reliability, and accessible UX. We focus on making messaging fast, private, and delightful.</p>`
    },
    "careers": {
      title: "Careers",
      content: `
        <h2>Careers</h2>
        <p>We're hiring! If you want to work on privacy-first communication, join us. We look for engineers, designers, product managers and community builders who value craftsmanship and user-first thinking. Visit our careers portal to view open roles and apply. We support remote and hybrid work arrangements where possible.</p>`
    },
    "brand-center": {
      title: "Brand Center",
      content: `
        <h2>Brand Center</h2>
        <p>The Brand Center contains logos, type guidelines, colors, and do/don't examples for using the MEGA brand. If you are a partner, follow these rules to ensure consistent representation. Misuse of the brand may result in takedown requests.</p>`
    },
    "privacy": {
      title: "Privacy",
      content: `
        <h2>Privacy Policy</h2>
        <p>Your privacy matters. This page details what information we collect, why we collect it, and how we protect it. We collect limited device and connectivity data to operate the service and help with support. Messages are designed to be ephemeral or device-local depending on your settings. Read the full policy for retention, sharing, and your rights.</p>`
    },
    "use-whatsapp": {
      title: "Use WhatsApp",
      content: `
        <h2>How to use MEGA</h2>
        <p>Quick-start guide: create an account, verify your phone, and start messaging. Use attachments to send images, videos, and documents, or start voice and video calls. Customize privacy and notification settings in the app Settings page. Tutorials and FAQs are available in the Help Center.</p>`
    },
    "android": {
      title: "Android",
      content: `
        <h2>Android</h2>
        <p>This section covers Android-specific installation, permissions, background behavior and troubleshooting. We explain how to allow notifications, manage battery optimizations, and use the app across multiple devices. For developers, documentation on intents and deep links is listed.</p>`
    },
    "iphone": {
      title: "iPhone",
      content: `
        <h2>iPhone</h2>
        <p>iOS installer instructions, privacy settings, and data usage tips. Learn how to enable microphone and camera permissions, set notification styles, and manage data backup. We also cover iCloud backup specifics and how to migrate chats securely between iPhones.</p>`
    },
    "desktop": {
      title: "Mac/PC",
      content: `
        <h2>Desktop (Mac / PC)</h2>
        <p>The desktop app provides a full-featured interface for messages, file transfer, and group management. Install from the official site or the platform store, and ensure your OS meets minimum requirements. Desktop sync options are described here.</p>`
    },
    "web": {
      title: "WhatsApp Web",
      content: `
        <h2>WhatsApp Web</h2>
        <p>Use the web client to access messages from your browser. Security notes: do not use public computers for sensitive conversations and always sign out after use. This page explains browser compatibility, file transfer limits, and troubleshooting tips.</p>`
    },
    "contact": {
      title: "Contact Us",
      content: `
        <h2>Contact Us</h2>
        <p>If you need help, contact our support team. Use the Help Center for guides and self-serve troubleshooting. For account or safety issues, use the support form to send details securely (do not include passwords in support requests).</p>`
    },
    "help": {
      title: "Help Center",
      content: `
        <h2>Help Center</h2>
        <p>Find FAQs, tutorials, and troubleshooting guides for common problems. Topics include account setup, verification, blocked contacts, archive chat, and more. The Help Center is regularly updated with community feedback and known issues.</p>`
    },
    "apps": {
      title: "Apps",
      content: `
        <h2>Apps</h2>
        <p>Overview of companion apps and integrations. Learn about official add-ons and how to connect third-party tools safely. Developer documentation for public APIs is available for approved partners.</p>`
    },
    "security-advisories": {
      title: "Security Advisories",
      content: `
        <h2>Security Advisories</h2>
        <p>Security advisories list discovered vulnerabilities, mitigations, and patch timelines. We follow responsible disclosure and publish advisories after affected users can update. Subscribe to advisories to receive important security notices.</p>`
    },
    "features": {
      title: "Features",
      content: `
        <h2>Features</h2>
        <p>MEGA includes messaging, voice/video calling, group chats, disappearing messages, and file sharing. This page details each feature, privacy implications, and configuration options so you can pick what fits your needs best.</p>`
    },
    "blog": {
      title: "Blog",
      content: `
        <h2>Blog</h2>
        <p>Read our latest announcements, engineering deep-dives, and product stories. The blog covers release notes, feature highlights, and community updates with practical tips and behind-the-scenes content.</p>`
    },
    "security": {
      title: "Security",
      content: `
        <h2>Security</h2>
        <p>We apply multiple layers of security: transport encryption, optional end-to-end encryption, secure storage practices, and strict access controls. Learn how we protect your data and steps you can take to stay secure.</p>`
    },
    "for-business": {
      title: "For Business",
      content: `
        <h2>For Business</h2>
        <p>Business tools and integrations for customer messaging, verified profiles, and analytics. This section includes onboarding guidance, pricing (if applicable), and case studies of businesses using MEGA securely at scale.</p>`
    },
    "who-we-are": {
      title: "Who we are",
      content: `
        <h2>Who we are</h2>
        <p>Mission statement, values, and team philosophy. Learn why we built MEGA, who is behind it, and how we approach privacy, product design, and developer collaboration.</p>`
    }
  };

  // DOM refs
  const linksGrid = document.getElementById('linksGrid');
  const pageView = document.getElementById('pageView');
  const pageTitle = document.getElementById('pageTitle');
  const pageContent = document.getElementById('pageContent');
  const pageBack = document.getElementById('pageBack');
  const fbYes = document.getElementById('fbYes');
  const fbNo = document.getElementById('fbNo');
  const reportModal = document.getElementById('reportModal');
  const sendReport = document.getElementById('sendReport');
  const cancelReport = document.getElementById('cancelReport');
  const reportText = document.getElementById('reportText');

  // Helpers
  function openPage(key, pushState = true) {
    const page = pages[key];
    if (!page) return console.warn('Unknown page', key);
    pageTitle.textContent = page.title;
    pageContent.innerHTML = page.content + `<hr><p style="font-size:0.95rem;color:#555">Last updated: ${new Date().toLocaleDateString()}</p>`;
    pageView.style.display = 'flex';
    pageView.setAttribute('aria-hidden', 'false');
    // focus for accessibility
    pageContent.focus();
    // track active page for report context
    pageView.dataset.activePage = key;
    if (pushState) {
      const url = new URL(location.href);
      url.searchParams.set('page', key);
      history.pushState({ page: key }, page.title, url.href);
    }
  }

  function closePage(pushState = true) {
    pageView.style.display = 'none';
    pageView.setAttribute('aria-hidden', 'true');
    pageView.dataset.activePage = '';
    if (pushState) {
      const url = new URL(location.href);
      url.searchParams.delete('page');
      history.pushState({}, '', url.href);
    }
  }

  // Link click wiring
  linksGrid.querySelectorAll('[data-page]').forEach(btn => {
    btn.addEventListener('click', (e) => {
      const key = btn.dataset.page;
      openPage(key, true);
    });
  });

  // Back button
  pageBack.addEventListener('click', () => closePage(true));
  // ESC closes
  document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closePage(true); });

  // Feedback buttons
  fbYes.addEventListener('click', () => {
    // simple thanks message
    alert('Thanks for the feedback!');
    // optionally record to localStorage
    saveFeedback(pageView.dataset.activePage, true, '');
  });

  fbNo.addEventListener('click', () => {
    // open report modal
    reportText.value = '';
    reportModal.style.display = 'flex';
    reportText.focus();
  });

  // Report modal actions
  sendReport.addEventListener('click', () => {
    const text = reportText.value.trim();
    const pageKey = pageView.dataset.activePage || 'unknown';
    if (!text) { alert('Please write a short message describing the issue'); reportText.focus(); return; }
    saveFeedback(pageKey, false, text);
    reportModal.style.display = 'none';
    alert('Thanks — your report has been received.');
  });

  cancelReport.addEventListener('click', () => {
    reportModal.style.display = 'none';
  });

  // Save feedback locally (replace with server call if desired)
  function saveFeedback(pageKey, positive, message) {
    try {
      const reports = JSON.parse(localStorage.getItem('site_feedback') || '[]');
      const entry = { page: pageKey, positive: !!positive, message: message || '', ts: new Date().toISOString() };
      reports.push(entry);
      localStorage.setItem('site_feedback', JSON.stringify(reports));
      console.log('Feedback saved', entry);
    } catch (e) { console.error(e); }
  }

  // Handle back/forward navigation to open pages from URL
  window.addEventListener('popstate', (ev) => {
    const key = (ev.state && ev.state.page) || new URL(location.href).searchParams.get('page');
    if (key) openPage(key, false); else closePage(false);
  });

  // On load, check ?page=...
  document.addEventListener('DOMContentLoaded', () => {
    const pageKey = new URL(location.href).searchParams.get('page');
    if (pageKey && pages[pageKey]) openPage(pageKey, false);
  });
})();
</script>
  <!-- Corner floating buttons -->
  <div class="corner-buttons" aria-hidden="false">
    <a href="#top" title="Home">🏠 Home</a>
    <button id="reportBtn" title="Report">🚨 Report</button>
    <a id="contactBtn" href="mailto:support@example.com" title="Contact">✉️ Contact</a>
  </div>
<!-- Social icons above the footer -->
<div class="social-icons">
  <a href="https://facebook.com/YourPage" target="_blank" class="social-link">
    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/facebook.svg" alt="Facebook">
  </a>
  <a href="https://www.instagram.com/chatmega435?igsh=OTk1bWxyMWVtbzZo" target="_blank" class="social-link">
    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/instagram.svg" alt="Instagram">
  </a>
  <a href="https://youtube.com/@megachat-f9p?si=JuKxKNQ2gpptlOwv" target="_blank" class="social-link">
    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/youtube.svg" alt="YouTube">
  </a>
  <a href="https://vm.tiktok.com/ZSH7rmAAkA2Yc-2r0eC/" target="_blank" class="social-link">
    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/tiktok.svg" alt="TikTok">
  </a>
</div>

<!-- Footer -->
<footer>© 2025 MEGA Chat — Built for secure and real-time connection</footer>

<style>
/* Social icons container */
.social-icons {
  display: flex;
  justify-content: center;
  gap: 16px;
  margin-top: 20px;
  margin-bottom: 10px;
}

/* Icon links */
.social-icons a {
  display: inline-block;
  width: 36px;
  height: 36px;
  filter: grayscale(100%); /* gray by default */
  transition: filter 0.2s, transform 0.2s;
}

/* Icon images fill container */
.social-icons a img {
  width: 100%;
  height: 100%;
}

/* Hover effect: colored + slight scale */
.social-icons a:hover {
  filter: none; /* remove grayscale */
  transform: scale(1.1);
}
</style>

  <!-- REPORT Modal (connected to Firebase) -->
  <div id="reportModal" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document" aria-labelledby="reportTitle">
      <h3 id="reportTitle">Report an Issue / Abuse</h3>
      <div class="field">
        <label for="rname">Your name (optional)</label>
        <input id="rname" type="text" placeholder="Your name">
      </div>
      <div class="field">
        <label for="remail">Your email (optional)</label>
        <input id="remail" type="email" placeholder="you@example.com">
      </div>
      <div class="field">
        <label for="rmessage">Describe the problem</label>
        <textarea id="rmessage" rows="5" placeholder="What happened? Be as detailed as you can..."></textarea>
      </div>
      <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:6px;">
        <button class="btn secondary" onclick="closeReportModal()">Cancel</button>
        <button class="btn" onclick="submitReport()">Send Report</button>
      </div>
      <p class="note">Reports are saved securely to Firestore and are viewable in your admin panel.</p>
    </div>
  </div>

  <!-- SUPPORT Modal (opens mailto on send) -->
  <div id="supportModal" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document" aria-labelledby="supportTitle">
      <h3 id="supportTitle">Contact Support</h3>
      <div class="field">
        <label for="smessage">Type your message to support</label>
        <textarea id="smessage" rows="6" placeholder="Describe your issue or question..."></textarea>
      </div>
      <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:6px;">
        <button class="btn secondary" onclick="closeSupportModal()">Cancel</button>
        <button class="btn" onclick="sendSupportEmail()">Send Message</button>
      </div>
      <p class="note">When you press <strong>Send Message</strong> your email client will open with the message prepared. (You can edit the email before sending.)</p>
    </div>
  </div>

  <script>
    /***********************
     * LONG MESSAGE BUILDER
     * We'll programmatically create a very long "About" message and inject a clickable "Support" link inside.
     ***********************/
    (function buildLongMessage() {
      // A single meaningful paragraph (approx ~700-1200 chars)
      const paragraphs = [
`MEGA Chat is a next-generation private messenger created to restore human connection and protect user privacy. At the heart of MEGA is a simple belief: conversations belong to the people having them. We designed MEGA to use peer-to-peer connections for messages and calls, minimizing centralized storage and data collection. This approach keeps your chats local to your devices while still giving you fast, real-time communication across the world.`,
`Privacy and security are not afterthoughts — they are MEGA’s foundation. We do not store message histories on our servers, and we do not scan or sell your data. The app uses modern WebRTC technology for calls and a secure signaling mechanism for connections. Status updates, “last seen,” and profile data are shared only with your saved contacts, not publicly.`,
`MEGA supports text messages, voice notes, photos, files, and high-quality voice & video calls. Our lightweight design keeps data usage low and performance high — even on slower networks. The app also includes small social features such as ephemeral statuses visible only to saved contacts, and a verification flow for trusted public accounts or admin numbers.`,
`We aim to be transparent: MEGA requests only essential permissions. We publish straightforward terms and a clear privacy policy. If anything unexpected happens or a feature feels confusing, our support team is ready to help. For technical problems, bugs, or reports of abuse, MEGA provides a reporting mechanism directly accessible from our website and inside the app.`,
`MEGA strives to be inclusive and accessible. We continue to improve usability by listening to feedback, prioritizing stability, and removing friction from common tasks: sending files, starting calls, and verifying contacts. We believe powerful privacy should also be simple and fast.`,
`If you rely on messaging for work, community organizing, or keeping in touch with family, you can trust MEGA to put control in your hands. We work hard to make updates reliable, maintain clear release notes, and preserve backward compatibility when possible. We welcome contributors and security researchers to responsibly disclose potential vulnerabilities so we can patch issues quickly.`
      ];

      // Build an extended message by repeating the block and adding small variations to make it feel natural.
      let longText = "";
      const targetApproxChars = 40000; // large — substantial long text while being practical
      while (longText.length < targetApproxChars) {
        // append each paragraph in order, but occasionally insert small variations
        for (let i=0;i<paragraphs.length && longText.length < targetApproxChars;i++){
          longText += paragraphs[i] + "\n\n";
          // Occasionally insert a short "how-to" paragraph
          if (Math.random() < 0.25) {
            longText += "How to use MEGA: Install, register with your phone number, allow microphone/camera for calls if you want to use voice/video features, add saved contacts, and start chatting. Use the Report button for bugs or abusive content, and tap Support if you need help from our team.\n\n";
          }
        }
        // small separator to avoid repetition feeling exactly the same
        longText += "— — —\n\n";
      }

      // Insert a visible Support link roughly in the first third
      const marker = "<span class='support-inline' id='inlineSupport'>Support</span>";
      // place it after ~20% of the text
      const insertAt = Math.floor(longText.length * 0.20);
      const injected = longText.slice(0, insertAt) + marker + longText.slice(insertAt);

      // render to page
      document.getElementById("longText").innerHTML = injected;

      // attach click to open support modal
      const inline = document.getElementById("inlineSupport");
      if (inline) inline.addEventListener("click", openSupportModal);
    })();

    /***********************
     * Modal open/close helpers
     ***********************/
    function openReportModal(){
      const m = document.getElementById('reportModal');
      m.style.display = 'flex';
      m.setAttribute('aria-hidden', 'false');
    }
    function closeReportModal(){
      const m = document.getElementById('reportModal');
      m.style.display = 'none';
      m.setAttribute('aria-hidden', 'true');
    }
    function openSupportModal(){
      const m = document.getElementById('supportModal');
      m.style.display = 'flex';
      m.setAttribute('aria-hidden', 'false');
    }
    function closeSupportModal(){
      const m = document.getElementById('supportModal');
      m.style.display = 'none';
      m.setAttribute('aria-hidden', 'true');
    }

    // attach report button
    document.getElementById('reportBtn').addEventListener('click', openReportModal);

    /***********************
     * Report submission: saves to Firestore via exposed function
     ***********************/
    async function submitReport(){
      const name = document.getElementById('rname').value.trim();
      const email = document.getElementById('remail').value.trim();
      const message = document.getElementById('rmessage').value.trim();

      if (!message) {
        alert('Please describe the issue before sending the report.');
        return;
      }

      // Basic payload
      const payload = {
        name: name || null,
        email: email || null,
        message,
        source: 'website-report'
      };

      // call the exposed Firestore helper
      try {
        // window.sendReportToFirestore is defined in the Firebase module script
        const res = await window.sendReportToFirestore(payload);
        if (res && res.ok) {
          alert('✅ Report sent. Thank you — our team will review it.');
          // clear and close
          document.getElementById('rname').value = '';
          document.getElementById('remail').value = '';
          document.getElementById('rmessage').value = '';
          closeReportModal();
        } else {
          throw res.error || new Error('unknown');
        }
      } catch (err) {
        console.error('Report submit error:', err);
        alert('❌ Failed to send report. Please try again later.');
      }
    }

    /***********************
     * Support email: open mailto with typed message
     ***********************/
    function sendSupportEmail(){
      const message = document.getElementById('smessage').value.trim();
      if (!message) { alert('Please type your message before sending.'); return; }

      // Placeholder email — replace with your real support email later
      const supportEmail = 'chatmega435@gmail.com';

      const subject = encodeURIComponent('MEGA Support Request');
      // We prefill a header and then the message, also append small metadata (optional)
      const bodyText = `Support message from MEGA website user:\n\n${message}\n\n---\nSent from MEGA website.`;
      const body = encodeURIComponent(bodyText);

      // Open mail client
      const mailto = `mailto:${supportEmail}?subject=${subject}&body=${body}`;
      window.location.href = mailto;

      // Reset and close
      document.getElementById('smessage').value = '';
      closeSupportModal();
    }

    // Close modals on backdrop click
    document.querySelectorAll('.modal-backdrop').forEach(backdrop => {
      backdrop.addEventListener('click', (e) => {
        if (e.target === backdrop) {
          // determine which modal
          if (backdrop.id === 'reportModal') closeReportModal();
          else if (backdrop.id === 'supportModal') closeSupportModal();
          else {
            // generic: hide
            backdrop.style.display = 'none';
            backdrop.setAttribute('aria-hidden','true');
          }
        }
      });
    });

    // Simple keyboard close (Escape)
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeReportModal();
        closeSupportModal();
      }
    });

    // Make contact button open user-editable mailto (placeholder email)
    // If you later want to set contact email dynamically, change href here:
    document.getElementById('contactBtn').href = 'mailto:chatmega435@gmail.com';

  </script>
</body>
</html>